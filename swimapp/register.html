<!--
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
+-   Author : Wang Zi Xiang                   +- 
+-   Unit   : Nccu cs 						  +- 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- 
-->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Nccu cs Wang test system</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- 	 <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
<!--     <script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script> -->
    <script src="assets/js/vendor/popper.min.js"></script>
    <script src="dist/js/bootstrap.min.js"></script>
    <script src="assets/js/vendor/holder.min.js"></script>
	<link href="dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="css/form-validation.css" rel="stylesheet">
	<style>
		.registerForm{
			margin-left: 18%;
		}

	</style>
</head>
<body class="bg-light">

    <div class="container">
      <div class="py-5 text-center">
        <!-- <h2>Checkout form</h2> -->
        <p class="lead"></p>
      </div>

      <div class="row">
        <div class="col-md-8 order-md-1 registerForm">
          <h4 class="mb-3">Registration Form</h4>
          <div class="needs-validation" novalidate>

			<div class="mb-3">
              <label for="username">Input Email</label>
              <div class="input-group">
              <!--   <div class="input-group-prepend">
                  <span class="input-group-text">@</span>
                </div> -->
                <input type="Email" class="form-control id" id="username" placeholder="" required>
                <div class="invalid-feedback" style="width: 100%;">
                  Your username is required.
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="username">Password</label>
              <div class="input-group">
               <!--  <div class="input-group-prepend">
                  <span class="input-group-text">@</span>
                </div> -->
                <input type="password" class="form-control pwd" id="username" placeholder="" required>
                <div class="invalid-feedback" style="width: 100%;">
                  Your username is required.
                </div>
              </div>
            </div>



            <div class="mb-3">
              <label for="username">Please Input Again Password</label>
              <div class="input-group">
                <input type="password" class="form-control pwd2" id="username" placeholder="" required>
                <div class="invalid-feedback" style="width: 100%;">
                  Your username is required.
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="email">User Name</label>
              <input type="text" class="form-control user_name" id="email" placeholder="">
              <div class="invalid-feedback">
                Please enter a valid email address for shipping updates.
              </div>
            </div>

            <div class="mb-3">
              <label for="address">user_info</label>
              <input type="text" class="form-control user_info" id="address" placeholder="" required>
              <div class="invalid-feedback">
                Please enter your shipping address.
              </div>
            </div>

            <hr class="mb-4">
            <button class="btn btn-primary btn-lg btn-block send">Continue to checkout</button>
          </div>
        </div>
      </div>

      <footer class="my-5 pt-5 text-muted text-center text-small">
        <p class="mb-1">&copy; 2017-2018 Company Name</p>
        <ul class="list-inline">
          <li class="list-inline-item"><a href="#">Privacy</a></li>
          <li class="list-inline-item"><a href="#">Terms</a></li>
          <li class="list-inline-item"><a href="#">Support</a></li>
        </ul>
      </footer>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
   
    <script>
      // Example starter JavaScript for disabling form submissions if there are invalid fields
      (function() {
        'use strict';

        window.addEventListener('load', function() {
          // Fetch all the forms we want to apply custom Bootstrap validation styles to
          var forms = document.getElementsByClassName('needs-validation');

          // Loop over them and prevent submission
          var validation = Array.prototype.filter.call(forms, function(form) {
            form.addEventListener('submit', function(event) {
              if (form.checkValidity() === false) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add('was-validated');
            }, false);
          });
        }, false);
      })();
    </script>
  </body>
<script>

	function check(email){
		let pattern = new RegExp('^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})*$');		
		if(email.match(pattern)){
			return true;
		}else{
			return false;
		}
	}
	$('.send').click(function () {
		let check_num=0;
		let id=$('.id').val();
		let pwd=$('.pwd').val();
		let pwd2=$('.pwd2').val();
		let user_name=$('.user_name').val();
		let user_info=$('.user_info').val();
		let data={};
		if(id.length==0 || !check(id)){
			$('.id').css({'background' : 'red'});
			
			if(check(id)==false){
				$('.alert').text("請輸入Email");
			}
		}else{
			$('.id').css({'background' : 'white'});
			$('.alert').css({"display": "none"});
			check_num++;
		}
		if(pwd.length==0){
			$('.pwd').css({'background' : 'red'});
		}else{
			$('.pwd').css({'background' : 'white'});
			check_num++;
		}
		if(pwd2.length==0){
			$('.pwd2').css({'background' : 'red'});
		}else{
			$('.pwd2').css({'background' : 'white'});
			check_num++;
		}
		if(user_name.length==0){
			$('.user_name').css({'background' : 'red'});
		}else{
			$('.user_name').css({'background' : 'white'});
			check_num++;
		}
		if(user_info.length==0){
			$('.user_info').css({'background' : 'red'});
		}else{
			$('.user_info').css({'background' : 'white'});
			check_num++;
		}
		if(pwd.length !=0 && pwd2.length !=0 && pwd!=pwd2){
			$('.pwd').css({'background' : 'green'});
			$('.pwd2').css({'background' : 'green'});
		}else{
			check_num++;
		}
		if(check_num==6){
			data.id=id;
			data.pwd=pwd;
			data.user_name=user_name;
			data.user_info=user_info;
			console.log(JSON.stringify(data));
			$.ajax({
				url:'model/register.php',
				type:'POST',
				cache:'false',
				data:data,
				success: function(result){
					if (result=="true") {
						document.location.href="index.html";
					}else{
						console.log(result);
						// JSON.stringify(result);
						let error=JSON.parse(result);
						$('.id').css({'background' : 'red'});
						$('.alert').text("Email 有人用了");
					}

				}

			});
		}

	});
</script>
</html>